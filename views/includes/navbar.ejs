<div class="testdiv">
    <div class="dropdown" onclick="toggleDropdown()">
        <button class="dropdown-btn">Select Bot<span><img src="/asset/down-arrow.png" alt="" /></span></button>
        <div id="dropdown-menu" class="dropdown-content" style="display: none;">
            <!-- Dropdown content will be generated dynamically -->
        </div>
    </div>

    <div class="options">
        <% if(!userdata) { %>
        <form action="/signup" method="POST">
        <a class="navbar-brand" href="/signup">Sign Up</a>
        </form>
        <form action="/login" method="POST">
        <a class="navbar-brand" href="login">Login</a>
        </form>
       <% }%> 
        <form action="/logout" method="POST">
        <a class="navbar-brand" href="logout">Logout</a>
        </form>
    </div>

</div>


<script>
async function saveSelectedModels(value) {
    console.log("Checkbox toggled:", value);
    const checkboxes = document.querySelectorAll("#dropdown-menu input[type='checkbox']");
    const selected = [];

    checkboxes.forEach(cb => {
        if (cb.checked) selected.push(cb.value);
    });

    // Send to backend for storing in session
    await fetch("/save-models", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
         body: JSON.stringify({ selectedmodels: selected })
    });
}

// Attach listener to each checkbox dynamically
function models(label = 'Default checkbox') {
    const dropdown = document.getElementById('dropdown-menu');
    if (document.getElementById(label)) return;

    const container = document.createElement('div');
    container.classList.add('form-check');

    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.value = label;
    checkbox.classList.add('form-check-input');
    checkbox.id = label;

    // ðŸ“Œ When user clicks/toggles checkbox â†’ Update backend session
    //checkbox.addEventListener('change', saveSelectedModels(checkbox.value));

    const labelElement = document.createElement('label');
    labelElement.classList.add('form-check-label');
    labelElement.htmlFor = label;
    labelElement.textContent = label;

    container.appendChild(checkbox);
    container.appendChild(labelElement);
    dropdown.appendChild(container);
}
// Toggle dropdown visibility and generate checkboxes
function toggleDropdown() {
    var dropdown = document.getElementById("dropdown-menu");
    if (dropdown.style.display === "none") {
        dropdown.style.display = "block";

        // Generate checkboxes dynamically
        models('Gemini');
        models('OpenAI');
        models('DeepSeek');
    } else {
        dropdown.style.display = "none";
    }
}

// Close dropdown when clicking outside
window.onclick = function(event) {
    if (!event.target.closest('.dropdown')) {
        var dropdown = document.getElementById("dropdown-menu");
        if (dropdown) {
            dropdown.style.display = "none";
        }
    }
};
console.log("Navbar loaded", );
</script>

